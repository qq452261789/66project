<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<style type="text/css">
			#span {
				width: 10px;
				height: 10px;
				position: absolute;
				left: 100px;
				top: 100px;
				background: blue;
				z-index: 100;
			}
		</style>
		<script src="jquery-1.12.0.js"></script>
		<script type="text/javascript">
			$(function() {
				//点击创建元素
				var $box, $_span = $("#span");
				var $btn = $('#btn');

				$btn.click(function() {
					$box = $("<div></div>");
					$box.addClass('is_createddiv')
					$box.css({
						"width": "120px",
						"height": "120px",
						"background": "red",
						"border-style": "solid",
						"border-color": "#333",
						"border-radius": "5px",
						"text-align": "center",
						"position": "absolute",
						"left": "30px",
						"top": "20px"
					});

					draggle($box);
					var $span_left = $box.offset().left;
					var $span_top = $box.offset().top;
					$_span.css({
						"left": $span_left,
						"top": $span_top,
					});
					$(document.body).append($box);

					$box.click(function() {
						$_span.css({
							"left": $span_left,
							"top": $span_top,
						});
					});

					span_draggle($_span);

				});
				//拖拽span 拉伸div	
				span_draggle($_span);

				function span_draggle(obj) {
					var span_mousex = 0,
						span_mousey = 0;
					var spanLeft, spanTop, changex, changey
					obj.mousedown(function(e) {

						spanLeft = parseInt($(this).offset().left, 10);
						spanTop = parseInt($(this).offset().top, 10);
						span_mousex = e.pageX;
						span_mousey = e.pageY;
						$(this).bind('mousemove', span_dragElement);
					});
					$(document).mouseup(function() {
						obj.unbind('mousemove');
					});

					function span_dragElement(event) {
						changex = event.pageX - span_mousex;
						changey = event.pageY - span_mousey;
						//console.log(changex);

						var left = spanLeft + changex;
						var top = spanTop + changey;
						$(this).css({
							"top": top,
							"left": left,
						});
						var newwidth = (120 + changex);
						var newheight = (120 + changey);
						$box.css({
							"width": newwidth,
							"height": newheight,
							
						});
						return false;
					}

				}
				//创建的元素拖拽
				function draggle(obj) {
					var mousex = 0,
						mousey = 0;
					var divLeft, divTop;

					obj.mousedown(function(e) {
						var offset = $(this).offset();
						divLeft = parseInt(offset.left, 10);
						divTop = parseInt(offset.top, 10);
						mousey = e.pageY;
						mousex = e.pageX;
						console.log(mousex, mousey)
						$(this).bind('mousemove', dragElement);
					});

					function dragElement(event) {
						var left = divLeft + (event.pageX - mousex);
						var top = divTop + (event.pageY - mousey);
						console.log(event.pageX, event.pageY);
						$(this).css({
							'top': top,
							'left': left,
							
						});
						return false;
					}
					$(document).mouseup(function() {
						$(document).unbind('mousemove');
					});
				}
			})
		</script>
	</head>

	<body>

		<button id="btn" type="button">创建一个div</button>
		<span id="span">
			
		</span>
	</body>

</html>