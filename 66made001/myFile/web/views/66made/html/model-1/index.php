<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="<?php echo base_url("web/views/66made/css/public/base.css"); ?>">
		<link rel="stylesheet" type="text/css" href="<?php echo base_url("web/views/66made/css/model-1/header.css"); ?>">
		<link rel="stylesheet" type="text/css" href="<?php echo base_url("web/views/66made/css/model-1/index.css"); ?>">
		<style type="text/css">
			.save_btn,.preview_btn{
				color:white;
				position:absolute;
				top:10px;
				left:10px;
				width:105px;
				font-size:20px;
				line-height: 30px;
				text-align: center;
				background-color:blue;
				opacity: 0.3;
				z-index: 10;
				border-radius: 5px;
				border:1px solid white;
			}
			.save_btn:hover{
				opacity:1;
			}
			.preview_btn{
				left:125px;
			}
			.preview_btn:hover{
				opacity:1;
			}
			body{
				position:relative;
			}
			#myfile{
				position:absolute;
				z-index: -100;
			}
		</style>

	</head>
	<body>
	<a href = "javascript:void(0);"class="save_btn">保存</a>
	<a href = "http://test.net/myFile/index.php/mypage/index_view"class="preview_btn">预览</a>
	<input type="file" name="myfile" id="myfile" accept="image/*">
	<div id="www">
		<div id="header_box">
			<div id="header" class="clearfix">
				<div id="log" class="left  edit_text">
					JAMES <span id="">CONSULTING</span>
				</div>
				<div id="nav" class="right">
					<a href="about.html" class="edit_text">
						关于
					</a>
					<a href="http://test.net/myFile/index.php/mypage/services_publish" class="edit_text">
						服务
					</a>
					<a href="projects.html" class="edit_text">
						项目
					</a>
					<a href="clients.html" class="edit_text">
						客户
					</a>
					<a href="#contact_box" class="edit_text">
						联系
					</a>
				</div>
			</div>
		</div>
		<div id="banner_box">
			<div class = "banner_bg" data-title = "白色条背景">
				
			</div>
			<div id="banner">
				<div id="banner_main">
					<p class="banner_main_p1 edit_text">
						开放创新战略
					</p>
					<p class="banner_main_p2 edit_text">
						实现增长
					</p>
				</div>
			</div>
		</div>
		<div id="main_box">
			<div id="main" class="clearfix">
				<div id="main_service" class="main_small_box">
					<p class="edit_text mian_title">
						服务
					</p>
					<p class="edit_text mian_article">
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
					</p>
					<a href="services.html">
						更多信息
					</a>
				</div>
				<div id="main_project" class="main_small_box">
					<p class="edit_text mian_title">
						项目
					</p>
					<p class="edit_text  mian_article">
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
					</p>
					<a href="projects.html">
						更多信息
					</a>
				</div>
				<div id="main_clients" class="main_small_box">
					<p class="edit_text mian_title">
						客户
					</p>
					<p class="edit_text  mian_article">
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
						此处可以添加文字。点击“编辑文本”或双击“添加内容”。
					</p>
					<a href="clients.html">
						更多信息
					</a>
				</div>
			</div>
		</div>
		<div id="about_box">
			<div id="about" class="clearfix">
				<div class="about_title">
					关于我们
				</div>
				<div  class="about_article edit_text">
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手的不同。
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手的不同。
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手的不同。
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手的不同。
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
						让用户更多的了解你。告诉你的访客和竞争对手意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手的不同。
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手的不同。
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手的不同。
					这里可以编辑段落文本。随意拖放到任意页面。
					在这里编辑贵公司的详细信息，关于你的团队和提供什么服务。
					让用户更多的了解你。告诉你的访客和竞争对手意拖放到任意页面。
				</div>
				<a  href="about.html" class="about_more about_href">
					阅读更多
				</a>
			</div>
		</div>
		<div id="contact_box">
			<div id="contact">
				<div class="contact_title">
					联系我们
				</div>
				<div class="contact_title_main clearfix">
					<div class="left map_box">
						<img class="edit_img" src="<?php echo base_url("web/views/66made/images/model-1/active/map.png"); ?>"/>

					</div>
					<div class="contact_maseeges right">
						<div class="company_info">
							<p class="edit_text ">
								地址：天河区珠江新城华夏路49号
							</p>
							<p class="edit_text">
								电话：020-87096175
							</p>
						</div>
						<div class="user_info">
							<p>
								<input type="text" name="user_name" id="" placeholder="姓名" value="" />	
							</p>
							<p>
								<input type="email" name="user_email" id="" placeholder="邮箱" value="" />
							</p>
							<p>
								<input type="text" name="user_them" id="" placeholder="主题" value="" />
							</p>
							<div>
								<textarea name="" rows="" cols="" placeholder="信息"></textarea>
							</div>
							<div class="user_send" type="button">
								发送
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="footer_box">
			<div id="footer" class="clearfix">
				<div id="" class="left">
					<a href="javascript:void(0)" class="edit_text footer_a1">
						2016  陆陆科技 
					</a>
					<a href="javascript:void(0)" class="edit_text footer_a2">
						66made.com
					</a>
				</div>
				<div id="share" class="right">
					<span id="share_weibo">
						<!--分享到微博-->
					</span>
					<span id="share_weixin">
						<!--分享到微信-->
					</span>
					<span id="share_qq">
						<!--分享到QQ-->
					</span>
				</div>
			</div>
		</div>
	</div>
	</body>
<script type="text/javascript" src="<?php echo base_url("static/js/jq.js"); ?>"></script>
<script type="text/javascript" src="<?php echo base_url("static/js/ajaxfileuploads.js"); ?>"></script>
<script type="text/javascript" src="<?php echo base_url("web/views/66made/js/model-1/index.js"); ?>"></script>
<script type="text/javascript">
 $(function(){
       
        function encodeUTF8(str){
        var temp = "",rs = "";
        for( var i=0 , len = str.length; i < len; i++ ){
            temp = str.charCodeAt(i).toString(16);
            rs  += "\\u"+ new Array(5-temp.length).join("0") + temp;
        }
            return rs;
        }
        function decodeUTF8(str){
            return str.replace(/(\\u)(\w{4}|\w{2})/gi, function($0,$1,$2){
                return String.fromCharCode(parseInt($2,16));
            }); 
        } 
        var top_ele ;
        //选择图片模块
        document.onclick = function(e){
            var e = e || e.event;
            var target = e.target || e.srcElement;
            console.log(target);
            if(target.className == "edit_img"){
                 top_ele = target;
                $("#myfile")[0].click();
            }
        }
        $("#myfile").change(function(){
            var file = "myfile";//指定文件域，即为上面input标签的id
            $.ajaxFileUpload({
                url: "<?php echo site_url("MadePage/uploadFile"); ?>", //用于文件上传的服务器端请求地址
                secureuri: false, //是否需要安全协议，一般设置为false
                async: false,
                fileElementId: file, //文件上传域的ID
                dataType: 'json', //返回值类型 一般设置为json
                success: function (data){ //服务器成功响应处理函数
                    // console.log(data[0].sourceurl);
                    $(top_ele).attr('src','<?php echo base_url("'+data[0].sourceurl+'")?>');
                }
            });
        });
        //点击预览的时候将数据存入数据库
        $(".save_btn").bind("click",function(){
            $(".edit_text").attr("contenteditable","false");
            var myhtml = $("#www").html();
            var enmyhtml = encodeUTF8(myhtml);
            $.ajax({
                type: "POST",
                url: "http://www.cpwix.com/index.php/MadePage/savePage",
                data: "modsid=1&content="+enmyhtml+"&pageid=4&title=1" ,
                datatype:"jsonp",
                success: function(msg){
                    alert("数据保存成功");
                }
            });     
     
        })

    // 渲染模块
        $.ajax({
            type: "GET",
            url: "http://www.cpwix.com/index.php/MadePage/getPage",
            data: "modsid=1&pageid=4" ,
            datatype:"jsonp",
            success: function(msg){
            	console.log(JSON.parse(msg).message);
            	$(".edit_text").attr("contenteditable","true");  
            	if(JSON.parse(msg).message != "操作失败" || JSON.parse(msg).message == undefined ){
            	console.log(1);
                var mm = JSON.parse(msg).pop();
                $("#www").html(decodeUTF8(mm.content));   
                $(".edit_text").attr("contenteditable","true");   
                new_element=document.createElement("script");
                new_element.setAttribute("type","text/javascript");
                new_element.setAttribute("src","<?php echo base_url("web/views/66made/js/model-1/index.js"); ?>");
                document.body.appendChild(new_element);
                   		
            	}

            }
        });

    });
 
</script>
</html>